---
title: "bat文件与cmd编码"
date: "2024-04-01" # 格式为 YYYY-MM-DD
categories: RrJm
tags:
  - windows
  - 批处理
summary: "bat文件的正常运行有赖于cmd编码与之匹配"
author: "ChatGPT"
---

# bat文件与cmd编码

## bat定义

BAT文件，全称为批处理文件（Batch File），是一种包含一系列命令的文本文件，用于批量执行命令或任务。

**工作方式：**
1. **文本文件：** BAT文件是纯文本文件，可以使用文本编辑器打开和编辑。
2. **命令序列：** BAT文件包含一系列命令，每个命令占据一行。这些命令可以是任何可在命令提示符下执行的命令，例如复制文件、移动文件、运行程序等。
3. **逐行执行：** 当运行BAT文件时，系统会逐行执行其中的命令，按照文件中的顺序依次执行。
4. **自动化任务：** BAT文件常用于自动化任务，例如批量处理文件、设置环境变量、执行备份等。
5. **简化操作：** 通过BAT文件，用户可以简化重复性操作，提高工作效率，尤其适用于需要重复执行相同任务的情况。

**使用注意事项：**
- **编码格式：** BAT文件的编码格式应与系统的命令提示符（CMD）的**编码格式匹配**，以确保正常运行。
- **权限：** BAT文件的运行**权限受限于用户**的权限设置，可能需要以管理员身份运行才能执行某些命令或任务。
- **稳定性：** 编写BAT文件时应注意**命令的稳定性和兼容性**，以避免意外错误或不良影响。

## 确定bat文件的编码
可以使用文本编辑器来确定BAT文件的编码格式。

打开BAT文件，可以使用Windows自带的记事本（Notepad）或者更强大的文本编辑器，比如Notepad++或Visual Studio Code。

大多数文本编辑器都会在界面的某个地方显示当前文件的编码格式。在Notepad++中，您可以在“格式”菜单下的“转换为UTF-8”中查看当前编码格式。在Visual Studio Code中，可以在右下角找到编码格式信息，点击可以切换编码格式。

如果文本编辑器无法显示编码格式，也可以尝试另存为其他编码格式，比如UTF-8或者ANSI，然后查看文件的变化。

## cmd编码与修改

常用编码及其对应的键值，包括一些东亚地区可能用到的编码：

```python
encoding_dict = {
    'ANSI': 437,
    'UTF-8': 65001,
    'Unicode (UTF-16 小端)': 1200,
    'Unicode (UTF-16 大端)': 1201,
    'Unicode (UTF-32 小端)': 12000,
    'Unicode (UTF-32 大端)': 12001,
    '简体中文 (GB2312)': 936,
    '繁体中文 (Big5)': 950,
    '韩文 (EUC-KR)': 51949,
    '日文 (Shift-JIS)': 932,
    '日文 (EUC-JP)': 20932,
    '日文 (ISO-2022-JP)': 50220,
    '日文 (ISO-2022-JP-1)': 50221,
    '日文 (ISO-2022-JP-2)': 50222,
    '日文 (UTF-8)': 65001,
    '日文 (UTF-16 小端)': 1200,
    '日文 (UTF-16 大端)': 1201,
    '日文 (UTF-32 小端)': 12000,
    '日文 (UTF-32 大端)': 12001,
    '台湾正体中文 (Big5)': 950,
    '韩文 (UTF-8)': 65001,
}
```
通过更改注册表来修改CMD的默认编码设置。以下是具体步骤：

**打开注册表编辑器：** 按下`Win + R`键打开“运行”对话框，输入`regedit`并按Enter打开注册表编辑器。

**导航到CMD的设置位置：** 在注册表编辑器中，导航到以下位置：

``` cmd
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Command Processor
```

**创建新的字符串值：** 在右侧窗口中，右键单击空白处，选择“新建” -> “字符串值”。

**命名新的字符串值：** 将新字符串值命名为`Autorun`。

**设置CMD编码：** 双击新创建的字符串值`Autorun`，在数值数据字段中输入以下命令来设置CMD的编码：

``` cmd
chcp <codepage>
```
   其中`<codepage>`是您希望设置的代码页。例如，要将编码设置为UTF-8，您可以输入`chcp 65001`。

**保存更改并关闭注册表编辑器：** 完成更改后，单击“确定”保存新值，然后关闭注册表编辑器。

**重新启动CMD：** 重新启动CMD窗口以应用新的编码设置。