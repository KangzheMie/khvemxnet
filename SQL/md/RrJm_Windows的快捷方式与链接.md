---
title: "Windows的快捷方式与链接"
date: "2024-03-13" # 格式为 YYYY-MM-DD
categories: RrJm
tags:
  - Windows
  - 文件管理
summary: "快捷方式是Windows操作系统的特性，它并不是一种可以通用的属性。而链接提供了一个更加底层的文件系统的访问手段。"
author: "ChatGPT"
---

# Windows的快捷方式与链接

## 软链接和硬链接

### 软链接（符号链接）
软链接，也称为符号链接，是一种文件引用，它指向文件系统中的另一个文件或目录。它就像是指向另一个位置的快捷方式，但是在许多操作系统和程序操作中表现得就像实际的文件或目录。

- **软链接的工作原理**：软链接（或符号链接）更像是一个指向文件或目录的快捷方式。它实际上是一个特殊的文件，里面包含了目标文件或目录的路径信息。当您通过软链接访问目标时，文件系统会解析这个链接，然后将您重定向到实际的文件或目录位置。

- **使用场景和优点**：软链接非常适合于需要跨文件系统链接文件或目录，或者当目标文件可能移动位置时的情况。软链接提供了更高的灵活性和便利性，但如果原始文件被移动或删除，软链接就会失效，因为它指向的路径不再存在。

- **特点**：
  - 可以跨文件系统创建。
  - 可以指向文件或目录。
  - 如果原始文件被删除或移动，链接将失效，指向一个不存在的路径。

- **创建命令**（Windows）：
  - 文件：`mklink Link Target`
  - 目录：`mklink /D Link Target`

### 硬链接
硬链接是文件系统中另一种类型的链接，它允许一个文件在文件系统中有多个有效路径名（即有多个名称指向同一文件）。与软链接不同，硬链接直接指向文件的物理位置，而不是像软链接那样通过路径名指向。

- **硬链接的工作原理**：硬链接直接指向文件系统中文件的物理数据块。在文件系统中，多个硬链接（文件名）可以关联到同一块物理数据。这意味着，不论通过哪个硬链接名访问文件，都是直接访问到同一个文件的内容。
  
- **使用场景和优点**：硬链接非常适用于需要为同一文件内容创建多个访问点，但不想占用额外磁盘空间的情况。由于所有硬链接直接关联到同一文件数据，删除或修改任一硬链接指向的文件会影响到所有硬链接。只有当最后一个硬链接被删除时，文件的数据才会从磁盘上删除。
  
- **特点**：
  - 只能在同一个文件系统中创建。
  - 只能指向文件，不能指向目录。
  - 即使原始文件名被删除，硬链接依然有效，因为硬链接和原始文件指向同一块磁盘空间。

- **创建命令**（Windows）：
  - `mklink /H Link Target`

### 命令行上的区别
在Windows命令行中，`mklink`命令用于创建链接。不同类型的链接需要使用不同的选项：

- **软链接**：
  - 对于文件：`mklink Link Target`
  - 对于目录：`mklink /D Link Target`
- **硬链接**：
  - 对于文件：`mklink /H Link Target`
  
其中，`Link`是链接文件的路径（您想要创建的链接），而`Target`是目标文件或目录的路径（已存在的文件或目录）。

### 总结
- **硬链接**：让文件数据本身似乎存在于多个位置，但所有这些位置实际上都直接指向同一块物理数据。这种方式没有“感觉像是可以访问”的概念；数据确实就在那里，通过任何一个硬链接都能访问到。
- **软链接**：创建了一个指向文件或目录实际位置的引用，使得通过软链接访问数据“感觉像是”直接访问，虽然数据实际上存储在另一个位置。软链接提供了一种灵活的方式来引用文件，但依赖于目标文件或目录的路径不变。


## 快捷方式和链接的区别
在Windows系统中，符号链接在视觉上和功能上与快捷方式相似，但它们在技术实现和使用场景上有所不同。让我详细解释一下这两者之间的主要区别，以及为什么在某些情况下，符号链接可能比快捷方式更加适用。

### 符号链接 vs 快捷方式
- **快捷方式**：快捷方式是Windows系统的一个特性，主要用于提供一个指向另一个文件或文件夹的引用。快捷方式本身是一个特殊的文件，带有`.lnk`扩展名，它包含了目标对象的路径信息。快捷方式主要是为了方便用户操作，比如从桌面或某个文件夹快速访问程序或文档。当你双击一个快捷方式时，系统会解析这个`.lnk`文件，并打开它指向的目标。
- **符号链接**：符号链接（又称软链接）是文件系统级别的链接，它创建了一个指向另一个文件或目录的指针。与快捷方式不同，符号链接对于操作系统和运行在其上的程序来说，就像是目标文件或目录本身。这意味着，无论是操作系统的文件管理功能还是大多数程序，都可以透明地通过符号链接访问目标内容，就好像它们是直接访问原始路径一样。

### 使用场景
- **快捷方式**：适用于为用户提供快速访问资源的场景。用户可以通过快捷方式快速打开程序、文件或文件夹，而无需浏览到它们的实际位置。
- **符号链接**：适用于需要让操作系统和程序认为链接所在位置就是实际数据所在位置的场景。这在开发、软件配置、以及需要跨文件系统工作的情况下特别有用。

### 为什么选择符号链接
在您的情况下，如果您的工程或其中使用的某些工具需要直接访问datasheet文件，而不是通过用户交互来打开这些文件，那么使用符号链接可能会更适合。符号链接可以保证在程序内部访问链接时，它们表现得就像实际的文件或目录，这可以确保兼容性和访问的连续性。

简而言之，尽管符号链接在外观上与快捷方式类似，但它们提供了更深层次的文件系统集成，对于某些自动化任务和程序访问场景来说，这是快捷方式所无法实现的。希望这个解释能够帮助您更好地理解这两者之间的区别，以及为什么在特定情况下符号链接是一个更优的选择。如果您有更多问题或需要进一步的帮助，请随时与我联系。

### 当系统访问快捷方式

当程序尝试访问一个快捷方式时，它实际上是在读取一个指向另一个文件或目录的`.lnk`文件。这意味着程序需要特别编写代码来解析这个快捷方式文件，以找到它实际指向的路径。这一过程涉及到与Windows系统的交互，因为`.lnk`文件的解析通常需要Windows API的支持。因此，如果一个跨平台的程序（即在Windows以外的操作系统上也能运行的程序）尝试访问一个快捷方式，而没有使用专门的代码来处理它，这个程序可能无法正确地找到目标文件或目录。

### 当系统访问链接
相比之下，符号链接对于访问它们的程序来说是透明的。当程序尝试访问一个符号链接时，操作系统自动将这个访问请求重定向到链接所指向的目标。对于访问这个链接的程序来说，这个过程是不可见的，它就好像是直接访问了目标文件或目录一样。这使得符号链接对于需要确保文件或目录访问连续性和一致性的程序和脚本来说，是一个非常有用的工具。它们可以广泛用于软件开发、系统管理和数据管理等多种场景。

因此，当您需要确保您的工程中的文件访问不受特定操作系统机制限制时，使用符号链接是一个更加合适的选择。这种方式提高了工程的兼容性和灵活性，尤其是在涉及到多种工具和环境的复杂项目中。




## 为什么同时有快捷方式和软链接
Windows快捷方式（.lnk文件）和软链接（符号链接）虽然功能相似，但它们服务于不同的目的和用户群体。下面是几个原因说明了为什么Windows会同时支持这两种机制：

### 1. 用户体验和易用性
- **快捷方式**设计之初，就是为了提供一个简单易用的方式让用户能够创建指向常用文件、程序和目录的引用。快捷方式易于创建和使用，用户可以通过图形用户界面（GUI）进行操作，无需命令行知识。快捷方式还可以携带额外信息，比如自定义图标、启动参数等，这增加了它们的灵活性和个性化设置的可能性。
  
### 2. 兼容性和历史原因
- **快捷方式**自Windows 95开始就引入了，那时操作系统的设计重点是图形用户界面和用户友好性。快捷方式很快成为Windows用户访问和组织文件的主要方式之一。相比之下，软链接（符号链接）是后来随着文件系统的发展（如NTFS）和Unix/Linux概念的引入而加入到Windows中的。维护快捷方式的支持确保了向后兼容性，这对于Windows操作系统来说是一个重要考虑。

### 3. 功能和技术差异
- **软链接**（符号链接）提供了文件系统级别的引用，对于开发人员和高级用户来说，这是处理复杂文件系统操作（如跨卷链接、开发环境设置等）的强大工具。相比之下，快捷方式虽然功能丰富，但主要是面向终端用户的，用于提高日常计算的便利性。

### 4. 安全性考虑
- 软链接可以链接到系统的任意位置，这可能会引入安全风险，比如通过软链接指向敏感或系统关键目录。Windows快捷方式以更受控的方式实现，减少了这类风险。

综上所述，快捷方式和软链接在Windows中共存，反映了微软在满足不同用户需求、保持系统兼容性、提供丰富功能以及确保操作系统安全性方面的综合考虑。快捷方式为普通用户提供了易于使用的界面，而软链接则为需要进行复杂文件操作的高级用户和开发人员提供了更多的控制能力。这种设计使得Windows操作系统能够满足广泛的用户基础和使用场景。



## 使用powershell(管理员模式)创建相对路径软链接
`New-Item`是PowerShell中的一个非常灵活的命令，用于创建多种类型的项，如文件、文件夹、注册表项等。在您提供的命令中，`New-Item`用于创建一个符号链接（SymbolicLink）。

```powershell
New-Item -ItemType SymbolicLink -Path ".\A" -Target "..\picture"
```

- `New-Item`: 这是PowerShell中用来创建新项的cmdlet。根据指定的参数，它可以创建文件、文件夹、注册表项、或者在此情况下的符号链接。

- `-ItemType SymbolicLink`: 指定要创建的项的类型。在这个例子中，`SymbolicLink`指示我们想要创建的是一个符号链接。符号链接是一个指向另一个文件或目录的引用，它可以跨文件系统工作。

- `-Path ".\A"`: 指定符号链接的路径和名称。在这个例子中，`.`代表当前目录，而`\A`意味着在当前目录下创建名为`A`的符号链接。路径可以是相对路径或绝对路径。

- `-Target "..\picture"`: 指定符号链接指向的目标路径。`..\picture`表示目标是当前目录的上一级目录中名为`picture`的文件或文件夹。同样，这里使用的是相对路径，但也可以使用绝对路径。




## 如何区分软连接和快捷方式

通过命令行也可以检查是符号链接还是快捷方式：
1. 打开命令提示符（CMD）或PowerShell。
2. 导航到包含该图标的文件夹。
3. 使用`dir`命令（在CMD中）或`Get-ChildItem`（在PowerShell中），然后查找对应的项。
   - 对于**快捷方式**，文件类型会是`.lnk`，这是Windows快捷方式的文件扩展名。
   - 对于**符号链接**，在命令输出中会看到`<SYMLINK>`（针对指向文件的符号链接）或`<SYMLINKD>`（针对指向目录的符号链接）的标记。

### 示例命令
- 在**CMD**中，可以直接使用`dir`命令：
```cmd
   dir
```
- 在**PowerShell**中，可以使用`Get-ChildItem`，或简写为`ls`或`dir`：
```PowerShell
   Get-ChildItem
```
   或
```bash
   ls
```

### 输出示例
``` powershell
User
Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d----l         3/14/2024   9:56 AM                A
-a----         3/14/2024   9:57 AM           1261 B.lnk
```
