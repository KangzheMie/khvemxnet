
<script>
  if (window.location.href.indexOf('?page=RrJm_2024-03-04_Verilog-case语句') === -1) {
    window.location.href = '/index.html?page=./blog/RrJm_2024-03-04_Verilog-case语句.html';
  }
</script>
<h1 id="verilog-case语句">Verilog case语句</h1>
<p>在 <strong>Verilog</strong> 中，<code>case</code>
语句是一种多分支选择语句，通常用于实现多路复用器。它检查给定的表达式是否与列表中的其他表达式之一匹配，并根据匹配情况执行相应的分支。如果有许多条件需要检查，使用多分支的
<code>if-else</code>
构造可能不合适，因为这会被综合成优先级编码器而不是多路复用器²。</p>
<p><code>case</code> 语句的一般形式如下：</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode verilog"><code class="sourceCode verilog"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">case</span> <span class="op">(</span>表达式<span class="op">)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="dv">case_item_1:</span> <span class="kw">begin</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 执行语句</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">case_item_2:</span> <span class="kw">begin</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 执行语句</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 更多 case_item...</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">default</span><span class="op">:</span> <span class="kw">begin</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// 默认执行语句</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="kw">endcase</span></span></code></pre></div>
<ul>
<li>在 <code>case</code>
语句中，敏感表达式与各项值之间的比较是一种全等比较，每一位都相同才认为匹配。</li>
<li>在 <code>casez</code> 语句中，如果分支表达式某些位的值为高阻
<code>z</code>，那么对这些位的比较会忽略，只关注其他位的比较结果。</li>
<li>在 <code>casex</code> 语句中，除了忽略高阻
<code>z</code>，还会忽略不定值
<code>x</code>，只关注其他位的比较结果。</li>
</ul>
<p>综合工具会将 <code>case</code>、<code>casez</code> 和
<code>casex</code>
统一处理，所以在综合出的电路中，它们的效果是一样的¹³⁵。</p>
<p>总结： - 尽量使用 <code>casez</code>，少用 <code>casex</code>。 -
在电路中，可以用 <code>?</code> 来表示无关值的 <code>z</code>。 -
<code>case</code> 的描述匹配是从上到下进行的。 - <code>casez</code>
可以处理不考虑高阻值 <code>z</code> 的比较过程。 - <code>casex</code>
不会关心 <code>x</code> 和 <code>z</code>，只管不是大大情况来匹配。</p>
<p>请注意，这里的 <code>case</code>
语句是可综合的，但在仿真时，不同的输入会产生不同的结果，因此在实际写代码时，需要根据具体情况选择合适的语句。</p>
