
<script>
    window.location.href = '/index.html?page=./blog/RrJm_2024-03-24_MATLAB工作区中table批量转为array.html';
</script>
<h1 id="table批量转为array">table批量转为array</h1>
<div class="sourceCode" id="cb1"><pre
class="sourceCode matlab"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">% 获取工作区中所有变量的详细信息</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="va">varsInfo</span> <span class="op">=</span> <span class="va">whos</span><span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">% 遍历所有变量</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="kw">for</span> <span class="va">i</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">length</span>(<span class="va">varsInfo</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">% 检查变量类型是否为&#39;table&#39;</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="va">strcmp</span>(<span class="va">varsInfo</span>(<span class="va">i</span>).<span class="va">class</span><span class="op">,</span> <span class="ss">&#39;table&#39;</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">% 获取表格变量的名称</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        <span class="va">tableName</span> <span class="op">=</span> <span class="va">varsInfo</span>(<span class="va">i</span>).<span class="va">name</span><span class="op">;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="co">% 读取表格变量</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">T</span> <span class="op">=</span> <span class="va">eval</span>(<span class="va">tableName</span>)<span class="op">;</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        <span class="co">% 尝试将表格转换为数组（仅当表格完全由数值组成时有效）</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">try</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">convertedArray</span> <span class="op">=</span> <span class="va">table2array</span>(<span class="va">T</span>)<span class="op">;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            <span class="co">% 存储或覆盖变量（这里是覆盖原始表格变量，您也可以选择创建新变量）</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>            <span class="va">assignin</span>(<span class="ss">&#39;base&#39;</span><span class="op">,</span> <span class="va">tableName</span><span class="op">,</span> <span class="va">convertedArray</span>)<span class="op">;</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        <span class="kw">catch</span> <span class="va">ME</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>            <span class="co">% 如果转换失败（例如，表格包含非数值列），输出错误信息</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>            <span class="va">fprintf</span>(<span class="ss">&#39;无法转换表格 &quot;%s&quot; 到数值矩阵: %s\n&#39;</span><span class="op">,</span> <span class="va">tableName</span><span class="op">,</span> <span class="va">ME</span>.<span class="va">message</span>)<span class="op">;</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        <span class="kw">end</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">end</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code></pre></div>
