
<script>
  if (window.location.href.indexOf('?page=RrJm_2024-03-10_使用Python处理PDF文件') === -1) {
    window.location.href = '/index.html?page=./blog/RrJm_2024-03-10_使用Python处理PDF文件.html';
  }
</script>
<h1 id="使用python处理pdf文件">使用Python处理PDF文件</h1>
<p>使用Python脚本确实可以完成对PDF文件的多种操作，包括分割、合并、以及转换为图片。这些操作主要通过第三方库来实现，其中一些广泛使用的库包括PyPDF2,
PDF2Image, 和PikePDF。</p>
<ol type="1">
<li><p><strong>分割PDF文件</strong>：可以使用PyPDF2或PikePDF库。这些库允许你读取PDF的每一页，并将选定的页面保存为新的PDF文件。</p></li>
<li><p><strong>合并PDF文件</strong>：同样，PyPDF2和PikePDF都提供了将多个PDF文件合并为一个PDF文件的功能。</p></li>
<li><p><strong>将PDF转为图片</strong>：PDF2Image是一个常用于将PDF页面转换成图片的库。它基于poppler工具，需要在系统上安装poppler环境。</p></li>
</ol>
<p>以下是使用这些库的基本示例：</p>
<h2 id="分割pdf">分割PDF</h2>
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PyPDF2 <span class="im">import</span> PdfReader, PdfWriter</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> split_pdf(input_pdf, start_page, end_page, output_pdf):</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    reader <span class="op">=</span> PdfReader(input_pdf)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    writer <span class="op">=</span> PdfWriter()</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(start_page, end_page <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        writer.add_page(reader.pages[i])</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(output_pdf, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> output_file:</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        writer.write(output_file)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 举例：分割PDF，选择页数1到3</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>split_pdf(<span class="st">&#39;input.pdf&#39;</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="st">&#39;output_split.pdf&#39;</span>)</span></code></pre></div>
<h2 id="合并pdf">合并PDF</h2>
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> PyPDF2 <span class="im">import</span> PdfReader, PdfWriter</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> merge_pdfs(pdf_list, output_pdf):</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    writer <span class="op">=</span> PdfWriter()</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pdf <span class="kw">in</span> pdf_list:</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        reader <span class="op">=</span> PdfReader(pdf)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> page <span class="kw">in</span> reader.pages:</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>            writer.add_page(page)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span>(output_pdf, <span class="st">&#39;wb&#39;</span>) <span class="im">as</span> output_file:</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>        writer.write(output_file)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 举例：合并两个PDF文件</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>merge_pdfs([<span class="st">&#39;pdf1.pdf&#39;</span>, <span class="st">&#39;pdf2.pdf&#39;</span>], <span class="st">&#39;merged_output.pdf&#39;</span>)</span></code></pre></div>
<h2 id="将pdf转为图片">将PDF转为图片</h2>
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pdf2image <span class="im">import</span> convert_from_path</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_pdf_to_images(pdf_file):</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    images <span class="op">=</span> convert_from_path(pdf_file)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, image <span class="kw">in</span> <span class="bu">enumerate</span>(images):</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        image.save(<span class="ss">f&#39;page_</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">.jpg&#39;</span>, <span class="st">&#39;JPEG&#39;</span>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 举例：转换PDF到图片</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>convert_pdf_to_images(<span class="st">&#39;document.pdf&#39;</span>)</span></code></pre></div>
<p>请注意，PDF2Image转换功能需要poppler的安装。具体安装方法依赖于您的操作系统。</p>
<h3 id="poppler是什么">poppler是什么</h3>
<p>Poppler是一个开源的PDF渲染库，基于xpdf-3.0代码。它主要用于PDF文件的渲染、文本提取以及其他与PDF相关的操作。Poppler库被设计成易于使用和集成，它支持多种编程语言，尽管最初是为C++环境开发的。Poppler的功能广泛，包括：</p>
<ul>
<li>渲染PDF内容到图像，可以是各种格式，如PNG、JPEG等。</li>
<li>提取PDF中的文本、字体、图形和嵌入的文件。</li>
<li>支持多种PDF特性，比如书签、链接和注释。</li>
<li>支持PDF加密和解密。</li>
</ul>
<p>Poppler库非常适合开发需要处理PDF文件的软件，比如PDF查看器、PDF转换工具或是文档管理系统。由于Poppler提供了底层的PDF处理能力，它可以用于构建复杂的PDF处理任务，如文档转换、内容分析和编辑功能。</p>
<p>在许多Linux发行版中，Poppler工具集被用作默认的PDF渲染引擎，并且可以通过包管理器轻松安装。对于Windows和MacOS用户，安装Poppler可能需要下载预编译的二进制文件或从源代码编译。</p>
<p>在Python中，PDF2Image库用于将PDF文件转换为图像，这背后就依赖于Poppler工具集。因此，在使用PDF2Image之前，需要确保系统中已安装Poppler，并且其命令行工具对Python环境可见。这通常涉及到将Poppler的bin目录添加到系统的PATH环境变量中。</p>
