
<script>
  if (window.location.href.indexOf('?page=RrJm_2024-04-27_更改gitignore后更新跟踪状态') === -1) {
    window.location.href = '/index.html?page=./blog/RrJm_2024-04-27_更改gitignore后更新跟踪状态.html';
  }
</script>
<h1 id="更改gitignore后更新跟踪状态">更改gitignore后更新跟踪状态</h1>
<p>在项目中修改了 <code>.gitignore</code> 文件后，Git
并不会自动重新应用新的忽略规则到已经被跟踪的文件。</p>
<p>希望让 Git 根据新的 <code>.gitignore</code>
文件来更新已跟踪的文件状态，需要手动告诉 Git 停止跟踪这些文件。</p>
<ol type="1">
<li><p><strong>更新 <code>.gitignore</code> 文件</strong></p></li>
<li><p><strong>更新 Git 仓库的跟踪状态</strong>：</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> rm <span class="at">-r</span> <span class="at">--cached</span> .</span></code></pre></div>
<p>这条命令会从 Git
的索引中移除所有文件（即停止跟踪所有文件）。<code>-r</code>
参数确保命令递归到每一个子目录，<code>--cached</code>
说明只更新索引，而不影响实际文件。</p></li>
<li><p><strong>添加所有文件到 Git 仓库</strong>：</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add .</span></code></pre></div>
<p>这次遵循更新后的 <code>.gitignore</code> 文件。因此，所有被
<code>.gitignore</code> 排除的文件都不会被添加。</p></li>
</ol>
<h2 id="如果想要保留文件夹本身">如果想要保留文件夹本身</h2>
<p>如果希望在 Git
仓库中保留一个空的文件夹，通常的做法是在这个文件夹中添加一个名为
<code>.gitkeep</code> 的空文件。</p>
<p>可以在这个文件夹中放置 <code>.gitkeep</code> 文件，并且在
<code>.gitignore</code> 文件中添加规则以忽略该文件夹中的其他文件。</p>
<ol type="1">
<li><p><strong>添加 <code>.gitkeep</code> 文件</strong>：</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">touch</span> path/to/folder/.gitkeep</span></code></pre></div></li>
<li><p><strong>忽略这个文件夹中的其他文件</strong>：</p>
<pre class="plaintext"><code>path/to/folder/*
!path/to/folder/.gitkeep</code></pre>
<p>这里的规则表示忽略 <code>path/to/folder/</code>
下的所有文件和子文件夹，但不忽略 <code>.gitkeep</code> 文件。</p></li>
<li><p><strong>加入到 Git 仓库</strong>：</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add path/to/folder/.gitkeep</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> add .gitignore</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">&quot;Add empty folder with .gitkeep and update .gitignore&quot;</span></span></code></pre></div></li>
</ol>
<p>通过这种方法，您就可以在项目中保留空文件夹，同时确保不跟踪该文件夹中的其他文件。</p>
